{% extends 'base.html' %}

{% block title %}キャバ嬢Q&A - 匿名掲示板{% endblock %}

{% block head_js %}
<script>
  function filterCategory(category) {
    const items = document.querySelectorAll('.qa-item');
    items.forEach(item => {
      if (category === 'all' || item.dataset.category === category) {
        item.classList.remove('hidden');
      } else {
        item.classList.add('hidden');
      }
    });

    const buttons = document.querySelectorAll('.category-button');
    buttons.forEach(btn => btn.classList.remove('bg-pink-400', 'text-white'));
    const activeBtn = document.querySelector(`[data-category-btn="${category}"]`);
    if (activeBtn) activeBtn.classList.add('bg-pink-400', 'text-white');
  }
</script>
{% endblock %}

{% block content %}
  <!-- 会員登録案内 -->
<section class="bg-pink-100 text-center p-4 text-sm">
  <p class="mb-1 font-semibold">🔐 この先のQ&Aをもっと読みたい？</p>
  <p class="mb-1">
    簡単な会員登録で <span class="font-bold">最初の10日間は無料</span>！<br>
    その後、初回3か月は月額 <span class="font-bold">1,000円</span>、<br>
    以降も月額 <span class="font-bold">1,000円</span> ですべて見放題に✨
  </p>
  <p class="mb-1 text-xs text-gray-600">※無料会員登録は数秒で完了、支払い情報の登録は不要です。</p>
  <p class="mb-1 text-xs text-gray-600">※無料会員登録は数秒で完了、支払い情報の登録は不要です。</p>
  <p class="mb-1 text-xs text-gray-600">※継続利用希望の場合には支払い情報の登録が必須です。</p>
  <button class="mt-2 bg-pink-400 hover:bg-pink-500 text-white text-sm px-6 py-2 rounded-full">
    今すぐ無料会員登録
  </button>
</section>

  <!-- カテゴリスライダー（スクロールバーなし） -->
  <div class="overflow-x-auto whitespace-nowrap p-2 bg-white shadow no-scrollbar">
    <button onclick="filterCategory('all')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="all">すべて</button>
    <button onclick="filterCategory('営業')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="営業">営業</button>
    <button onclick="filterCategory('客層')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="客層">客層</button>
    <button onclick="filterCategory('出勤')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="出勤">出勤</button>
    <button onclick="filterCategory('美容')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="美容">美容</button>
    <button onclick="filterCategory('恋愛')" class="category-button inline-block bg-pink-200 hover:bg-pink-300 text-sm px-3 py-1 rounded-full mx-1" data-category-btn="恋愛">恋愛</button>
  </div>

  <!-- 最新Q&Aリスト -->
  <section class="p-3">
    <h2 class="text-lg font-bold mb-3">📌 最新の質問（{{ questions|length }}件）</h2>
    <div class="space-y-3">
      {% if questions %}
        {% for question in questions %}
          <div class="qa-item bg-white p-3 rounded-xl shadow" data-category="{{ question.category }}">
            <h3 class="font-semibold text-base">Q. {{ question.title }}</h3>
            <p class="text-xs text-gray-500 mb-1">💬 回答数：{{ question.answer_count }}件</p>
            {% if question.answers %}
              <p class="mt-1 text-sm text-gray-800">A. {{ question.answers[0].content|truncate(50) }}</p>
            {% else %}
              <p class="mt-1 text-sm text-gray-500 italic">まだ回答がありません。</p>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <div class="text-center py-4 bg-white rounded-xl shadow">
          <p class="text-gray-500">まだ質問がありません。</p>
          <button class="mt-2 bg-pink-400 hover:bg-pink-500 text-white text-sm px-6 py-2 rounded-full">最初の質問を投稿する</button>
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}
